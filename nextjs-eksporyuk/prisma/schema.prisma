generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model ActivityLog {
  id        String   @id
  userId    String?
  action    String
  entity    String
  entityId  String?
  ipAddress String?
  userAgent String?
  metadata  Json?
  createdAt DateTime @default(now())
}

model AffiliateAutomation {
  id          String   @id
  affiliateId String
  name        String
  triggerType String
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime
}

model AffiliateAutomationJob {
  id             String    @id
  automationId   String
  stepId         String
  leadId         String
  affiliateId    String
  status         String    @default("pending")
  scheduledAt    DateTime
  executedAt     DateTime?
  failedAt       DateTime?
  errorMessage   String?
  retryCount     Int       @default(0)
  maxRetries     Int       @default(3)
  creditDeducted Boolean   @default(false)
  creditAmount   Int       @default(1)
  emailSent      Boolean   @default(false)
  emailId        String?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
}

model AffiliateAutomationLog {
  id               String    @id
  automationId     String
  leadId           String
  affiliateId      String
  triggerType      String
  triggerData      String?
  status           String    @default("active")
  currentStepOrder Int       @default(1)
  totalSteps       Int       @default(0)
  completedSteps   Int       @default(0)
  failedSteps      Int       @default(0)
  startedAt        DateTime  @default(now())
  pausedAt         DateTime?
  completedAt      DateTime?
  lastExecutedAt   DateTime?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime
}

model AffiliateAutomationStep {
  id           String   @id
  automationId String
  stepOrder    Int
  delayHours   Int      @default(0)
  emailSubject String
  emailBody    String
  isActive     Boolean  @default(true)
  sentCount    Int      @default(0)
  openedCount  Int      @default(0)
  clickedCount Int      @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime
}

model AffiliateBioCTA {
  id               String   @id
  bioPageId        String
  buttonText       String
  buttonType       String
  buttonStyle      String   @default("button")
  targetType       String?
  targetId         String?
  targetUrl        String?
  membershipId     String?
  productId        String?
  courseId         String?
  optinFormId      String?
  optinDisplayMode String   @default("button")
  backgroundColor  String   @default("#3B82F6")
  textColor        String   @default("#FFFFFF")
  thumbnailUrl     String?
  price            String?
  originalPrice    String?
  subtitle         String?
  showPrice        Boolean  @default(false)
  showThumbnail    Boolean  @default(false)
  titleSize        String   @default("sm")
  subtitleSize     String   @default("xs")
  buttonTextSize   String   @default("sm")
  displayOrder     Int      @default(0)
  clicks           Int      @default(0)
  isActive         Boolean  @default(true)
  createdAt        DateTime @default(now())
  updatedAt        DateTime
}

model AffiliateBioPage {
  id                String   @id
  affiliateId       String
  template          String   @default("modern")
  buttonLayout      String   @default("stack")
  displayName       String?
  customHeadline    String?
  customDescription String?
  avatarUrl         String?
  coverImage        String?
  whatsappGroupLink String?
  whatsappNumber    String?
  primaryColor      String   @default("#3B82F6")
  secondaryColor    String   @default("#10B981")
  fontFamily        String   @default("inter")
  showSocialIcons   Boolean  @default(true)
  socialFacebook    String?
  socialInstagram   String?
  socialTwitter     String?
  socialTiktok      String?
  socialYoutube     String?
  isActive          Boolean  @default(true)
  viewCount         Int      @default(0)
  createdAt         DateTime @default(now())
  updatedAt         DateTime
}

model AffiliateBroadcast {
  id              String    @id
  affiliateId     String
  name            String
  subject         String
  body            String
  templateId      String?
  status          String    @default("DRAFT")
  targetSegment   Json?
  totalRecipients Int       @default(0)
  sentCount       Int       @default(0)
  deliveredCount  Int       @default(0)
  openedCount     Int       @default(0)
  clickedCount    Int       @default(0)
  failedCount     Int       @default(0)
  creditUsed      Int       @default(0)
  isScheduled     Boolean   @default(false)
  scheduledAt     DateTime?
  sentAt          DateTime?
  completedAt     DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime
  recurringConfig Json?
}

model AffiliateBroadcastLog {
  id           String    @id
  broadcastId  String
  leadId       String
  status       String    @default("PENDING")
  sentAt       DateTime?
  deliveredAt  DateTime?
  openedAt     DateTime?
  clickedAt    DateTime?
  failedAt     DateTime?
  errorMessage String?
  createdAt    DateTime  @default(now())
}

model AffiliateCTATemplate {
  id              String   @id
  name            String
  buttonText      String
  buttonType      String
  description     String?
  backgroundColor String   @default("#3B82F6")
  textColor       String   @default("#FFFFFF")
  icon            String?
  isActive        Boolean  @default(true)
  useCount        Int      @default(0)
  displayOrder    Int      @default(0)
  createdAt       DateTime @default(now())
  updatedAt       DateTime
}

model AffiliateChallenge {
  id           String   @id
  title        String
  description  String
  targetType   String
  targetValue  Decimal
  rewardType   String
  rewardValue  Decimal
  startDate    DateTime
  endDate      DateTime
  isActive     Boolean  @default(true)
  membershipId String?
  productId    String?
  courseId     String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime

  @@index([courseId])
  @@index([membershipId])
  @@index([productId])
  @@index([startDate, endDate])
}

model AffiliateChallengeProgress {
  id              String    @id
  challengeId     String
  affiliateId     String
  currentValue    Decimal   @default(0)
  completed       Boolean   @default(false)
  completedAt     DateTime?
  rewardClaimed   Boolean   @default(false)
  claimedAt       DateTime?
  rewardStatus    String    @default("NOT_CLAIMED")
  approvedBy      String?
  approvedAt      DateTime?
  rejectionReason String?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime

  @@unique([challengeId, affiliateId])
  @@index([affiliateId])
  @@index([challengeId])
  @@index([rewardStatus])
}

model AffiliateClick {
  id           String    @id
  linkId       String?
  affiliateId  String?
  ipAddress    String
  userAgent    String
  referrer     String?
  productId    String?
  membershipId String?
  convertedAt  DateTime?
  createdAt    DateTime  @default(now())

  @@index([affiliateId])
  @@index([createdAt])
  @@index([linkId])
}

model AffiliateConversion {
  id               String    @id
  affiliateId      String
  transactionId    String    @unique
  commissionAmount Decimal
  commissionRate   Decimal
  paidOut          Boolean   @default(false)
  paidOutAt        DateTime?
  createdAt        DateTime  @default(now())

  @@index([affiliateId])
  @@index([transactionId])
}

model AffiliateCredit {
  id          String   @id
  affiliateId String
  balance     Int      @default(0)
  totalTopUp  Int      @default(0)
  totalUsed   Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime
}

model AffiliateCreditTransaction {
  id            String   @id
  creditId      String
  affiliateId   String
  type          String
  amount        Int
  balanceBefore Int
  balanceAfter  Int
  description   String?
  referenceType String?
  referenceId   String?
  paymentId     String?
  status        String   @default("COMPLETED")
  createdAt     DateTime @default(now())
}

model AffiliateEmailTemplate {
  id           String   @id
  name         String
  slug         String
  category     String
  subject      String
  body         String
  previewText  String?
  description  String?
  thumbnailUrl String?
  isDefault    Boolean  @default(false)
  isActive     Boolean  @default(true)
  useCount     Int      @default(0)
  createdById  String
  createdAt    DateTime @default(now())
  updatedAt    DateTime
}

model AffiliateLead {
  id              String    @id
  affiliateId     String
  optinFormId     String?
  name            String
  email           String?
  phone           String?
  whatsapp        String?
  status          String    @default("new")
  source          String    @default("optin")
  notes           String?
  lastContactedAt DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime
}

model AffiliateLeadTag {
  id        String   @id
  leadId    String
  tag       String
  createdAt DateTime @default(now())
}

model AffiliateLink {
  id           String            @id @default(cuid())
  userId       String?
  affiliateId  String?
  productId    String?
  membershipId String?
  courseId     String?
  supplierId   String?
  code         String            @unique
  shortCode    String?           @unique
  fullUrl      String?
  couponCode   String?
  linkType     AffiliateLinkType @default(CHECKOUT)
  clicks       Int               @default(0)
  conversions  Int               @default(0)
  isActive     Boolean           @default(true)
  isArchived   Boolean           @default(false)
  expiresAt    DateTime?
  createdAt    DateTime          @default(now())
  updatedAt    DateTime          @updatedAt
  affiliate    AffiliateProfile? @relation(fields: [affiliateId], references: [id], onDelete: Cascade)
  course       Course?           @relation(fields: [courseId], references: [id], onDelete: Cascade)
  membership   Membership?       @relation(fields: [membershipId], references: [id], onDelete: Cascade)
  product      Product?          @relation(fields: [productId], references: [id], onDelete: Cascade)
  supplier     SupplierProfile?  @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  user         User?             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([affiliateId])
  @@index([code])
  @@index([shortCode])
  @@index([userId])
}

model AffiliateMaterial {
  id            String   @id
  title         String
  description   String
  type          String
  category      String
  fileUrl       String?
  content       String?
  thumbnailUrl  String?
  downloadCount Int      @default(0)
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime

  @@index([category])
  @@index([isActive])
  @@index([type])
}

model AffiliateOptinForm {
  id               String    @id
  affiliateId      String
  bioPageId        String?
  slug             String?
  formName         String
  headline         String
  description      String?
  submitButtonText String    @default("Submit")
  successMessage   String    @default("Terima kasih! Data Anda telah kami terima.")
  redirectType     String    @default("message")
  redirectUrl      String?
  redirectWhatsapp String?
  collectName      Boolean   @default(true)
  collectEmail     Boolean   @default(true)
  collectPhone     Boolean   @default(true)
  isActive         Boolean   @default(true)
  submissionCount  Int       @default(0)
  bannerTitle      String?
  bannerSubtitle   String?
  bannerBadgeText  String?   @default("Event Terbatas - Daftar Sekarang!")
  primaryColor     String?   @default("#2563eb")
  secondaryColor   String?   @default("#4f46e5")
  showCountdown    Boolean   @default(false)
  countdownEndDate DateTime?
  benefits         Json?     @default("[]")
  faqs             Json?     @default("[]")
  createdAt        DateTime  @default(now())
  updatedAt        DateTime
}

model AffiliateProfile {
  id                    String          @id
  userId                String          @unique
  affiliateCode         String          @unique
  shortLink             String          @unique
  shortLinkUsername     String?         @unique
  tier                  Int             @default(1)
  commissionRate        Decimal         @default(10)
  totalClicks           Int             @default(0)
  totalConversions      Int             @default(0)
  totalSales            Decimal         @default(0)
  totalEarnings         Decimal         @default(0)
  isActive              Boolean         @default(true)
  applicationStatus     String          @default("PENDING")
  applicationNotes      String?
  bankName              String?
  bankAccountName       String?
  bankAccountNumber     String?
  whatsapp              String?
  motivation            String?
  approvedAt            DateTime?
  welcomeShown          Boolean         @default(false)
  onboardingCompleted   Boolean         @default(false)
  onboardingCompletedAt DateTime?
  trainingCompleted     Boolean         @default(false)
  trainingCompletedAt   DateTime?
  firstLinkCreated      Boolean         @default(false)
  firstLinkCreatedAt    DateTime?
  profileCompleted      Boolean         @default(false)
  profileCompletedAt    DateTime?
  bankInfoCompleted     Boolean         @default(false)
  bankInfoCompletedAt   DateTime?
  createdAt             DateTime        @default(now())
  updatedAt             DateTime
  affiliateLinks        AffiliateLink[]
  user                  User            @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([affiliateCode])
  @@index([shortLinkUsername])
  @@index([userId])
}

model AffiliateShortLink {
  id              String    @id
  affiliateId     String
  domainId        String
  username        String
  slug            String?
  targetType      String
  targetId        String?
  targetUrl       String?
  fullShortUrl    String
  affiliateLinkId String?
  couponCode      String?
  clicks          Int       @default(0)
  conversions     Int       @default(0)
  isActive        Boolean   @default(true)
  expiresAt       DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime
}

model ApiKey {
  id          String    @id
  name        String
  key         String
  permissions Json
  isActive    Boolean   @default(true)
  lastUsedAt  DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime
}

model Assignment {
  id                  String    @id
  courseId            String
  lessonId            String?
  title               String
  description         String
  instructions        String?
  maxScore            Int       @default(100)
  dueDate             DateTime?
  allowLateSubmission Boolean   @default(false)
  allowedFileTypes    String?
  maxFileSize         Int?
  attachments         String?
  links               String?
  isActive            Boolean   @default(true)
  createdAt           DateTime  @default(now())
  updatedAt           DateTime
}

model AssignmentSubmission {
  id           String           @id
  assignmentId String
  userId       String
  content      String?
  fileUrl      String?
  fileName     String?
  status       SubmissionStatus @default(SUBMITTED)
  score        Int?
  feedback     String?
  gradedBy     String?
  gradedAt     DateTime?
  submittedAt  DateTime         @default(now())
  updatedAt    DateTime
}

model BadgeDefinition {
  id          String        @id
  name        String
  slug        String
  description String
  icon        String
  color       String        @default("#3B82F6")
  category    BadgeCategory @default(PARTICIPATION)
  conditions  Json?
  points      Int           @default(0)
  isActive    Boolean       @default(true)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime
}

model BannedUser {
  id         String    @id
  userId     String
  groupId    String?
  reason     String
  bannedById String
  expiresAt  DateTime?
  createdAt  DateTime  @default(now())
}

model Banner {
  id                String          @id
  title             String
  description       String?
  imageUrl          String?
  videoUrl          String?
  linkUrl           String
  linkText          String?         @default("Lihat Selengkapnya")
  targetRoles       Json
  targetMemberships Json?
  targetProvinces   Json?
  placement         BannerPlacement @default(DASHBOARD)
  displayType       BannerType      @default(CAROUSEL)
  backgroundColor   String?         @default("#3B82F6")
  textColor         String?         @default("#FFFFFF")
  buttonColor       String?         @default("#FFFFFF")
  buttonTextColor   String?         @default("#3B82F6")
  priority          Int             @default(0)
  startDate         DateTime
  endDate           DateTime
  isActive          Boolean         @default(true)
  viewLimit         Int?
  clickLimit        Int?
  dailyBudget       Int?
  createdBy         String
  isSponsored       Boolean         @default(false)
  sponsorName       String?
  sponsorLogo       String?
  totalViews        Int             @default(0)
  totalClicks       Int             @default(0)
  totalBudgetUsed   Decimal         @default(0)
  createdAt         DateTime        @default(now())
  updatedAt         DateTime
}

model BannerClick {
  id        String   @id
  bannerId  String
  userId    String?
  sessionId String?
  ipAddress String?
  userAgent String?
  referer   String?
  clickedAt DateTime @default(now())
}

model BannerView {
  id        String   @id
  bannerId  String
  userId    String?
  sessionId String?
  ipAddress String?
  userAgent String?
  referer   String?
  viewedAt  DateTime @default(now())
}

model BrandedTemplate {
  id             String    @id
  name           String
  slug           String
  description    String?
  category       String
  type           String
  roleTarget     String?
  subject        String
  content        String
  ctaText        String?
  ctaLink        String?
  priority       String    @default("NORMAL")
  isDefault      Boolean   @default(false)
  isSystem       Boolean   @default(false)
  isActive       Boolean   @default(true)
  customBranding Json?
  usageCount     Int       @default(0)
  lastUsedAt     DateTime?
  tags           Json?
  variables      Json?
  previewData    Json?
  createdBy      String?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
}

model EmailNotificationLog {
  id                 String    @id @default(cuid())
  templateId         String
  templateSlug       String
  templateCategory   String
  recipientId        String
  recipientEmail     String
  recipientName      String?
  recipientRole      String?
  subject            String
  bodyPreview        String?
  variables          Json?
  status             String    @default("QUEUED")
  sentAt             DateTime?
  deliveredAt        DateTime?
  openedAt           DateTime?
  clickedAt          DateTime?
  clickUrl           String?
  failureReason      String?
  bounceReason       String?
  spamReported       Boolean   @default(false)
  openCount          Int       @default(0)
  clickCount         Int       @default(0)
  externalMessageId  String?
  internalTrackingId String    @unique @default(cuid())
  sourceType         String?
  sourceId           String?
  transactionId      String?
  openIpAddress      String?
  openUserAgent      String?
  clickIpAddress     String?
  clickUserAgent     String?
  metadata           Json?
  retryCount         Int       @default(0)
  nextRetryAt        DateTime?
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt

  @@index([recipientId])
  @@index([templateSlug])
  @@index([status])
  @@index([sourceType])
  @@index([createdAt])
}

model BrandedTemplateUsage {
  id         String   @id
  templateId String
  userId     String?
  userRole   String?
  context    String?
  success    Boolean  @default(true)
  error      String?
  metadata   Json?
  createdAt  DateTime @default(now())
}

model BroadcastCampaign {
  id                      String    @id
  name                    String
  type                    String
  status                  String    @default("DRAFT")
  templateId              String?
  templateType            String?
  targetType              String
  targetRoles             Json?
  targetMembershipIds     Json?
  targetGroupIds          Json?
  targetCourseIds         Json?
  targetEventIds          Json?
  targetTransactionStatus Json?
  targetTransactionType   Json?
  customUserIds           Json?
  emailSubject            String?
  emailBody               String?
  emailCtaText            String?
  emailCtaLink            String?
  whatsappMessage         String?
  whatsappCtaText         String?
  whatsappCtaLink         String?
  scheduledAt             DateTime?
  startedAt               DateTime?
  completedAt             DateTime?
  totalRecipients         Int       @default(0)
  sentCount               Int       @default(0)
  deliveredCount          Int       @default(0)
  failedCount             Int       @default(0)
  openedCount             Int       @default(0)
  clickedCount            Int       @default(0)
  createdById             String
  createdAt               DateTime  @default(now())
  updatedAt               DateTime
}

model BroadcastLog {
  id           String    @id
  campaignId   String
  userId       String
  channel      String
  status       String    @default("PENDING")
  sentAt       DateTime?
  deliveredAt  DateTime?
  openedAt     DateTime?
  clickedAt    DateTime?
  failedAt     DateTime?
  errorMessage String?
  metadata     Json?
  createdAt    DateTime  @default(now())
}

model Buyer {
  id               String    @id
  productName      String?
  productSpecs     String?
  quantity         String?
  shippingTerms    String?
  destinationPort  String?
  paymentTerms     String?
  companyName      String
  country          String
  city             String?
  address          String?
  contactPerson    String?
  email            String?
  phone            String?
  website          String?
  businessType     String?
  productsInterest String?
  annualImport     String?
  isVerified       Boolean   @default(false)
  verifiedBy       String?
  verifiedAt       DateTime?
  rating           Float?    @default(0)
  totalDeals       Int       @default(0)
  tags             String?
  notes            String?
  addedBy          String
  viewCount        Int       @default(0)
  likeCount        Int       @default(0)
  createdAt        DateTime  @default(now())
  updatedAt        DateTime
}

model BuyerLike {
  id      String   @id
  userId  String
  buyerId String
  likedAt DateTime @default(now())
}

model BuyerView {
  id       String   @id
  userId   String
  buyerId  String
  viewedAt DateTime @default(now())
}

model Certificate {
  id                    String   @id
  userId                String
  courseId              String
  certificateNumber     String
  completedAt           DateTime
  issuedAt              DateTime @default(now())
  studentName           String
  courseName            String
  completionDate        DateTime
  certificateTemplateId String?
  pdfUrl                String?
  isValid               Boolean  @default(true)
  verificationUrl       String?
}

model CertificateTemplate {
  id              String   @id
  name            String
  description     String?
  backgroundColor String   @default("#FFFFFF")
  primaryColor    String   @default("#3B82F6")
  secondaryColor  String?
  textColor       String   @default("#1F2937")
  layout          String   @default("MODERN")
  logoUrl         String?
  signatureUrl    String?
  backgroundImage String?
  borderStyle     String?
  fontFamily      String   @default("Inter")
  titleFontSize   String   @default("3xl")
  mentorName      String?
  directorName    String?
  showLogo        Boolean  @default(true)
  showSignature   Boolean  @default(true)
  showQrCode      Boolean  @default(true)
  showBorder      Boolean  @default(true)
  isActive        Boolean  @default(true)
  isDefault       Boolean  @default(false)
  createdAt       DateTime @default(now())
  updatedAt       DateTime
}

model ChallengProgress {
  id          String    @id
  challengeId String
  userId      String
  progress    Int       @default(0)
  isCompleted Boolean   @default(false)
  completedAt DateTime?
  rank        Int?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime
}

model ChatParticipant {
  id          String    @id @default(cuid())
  roomId      String
  userId      String
  lastReadAt  DateTime?
  unreadCount Int       @default(0)
  isMuted     Boolean   @default(false)
  isPinned    Boolean   @default(false)
  joinedAt    DateTime  @default(now())
  room        ChatRoom  @relation(fields: [roomId], references: [id], onDelete: Cascade)
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([roomId, userId])
  @@index([roomId])
  @@index([userId])
}

model ChatRoom {
  id            String            @id @default(cuid())
  type          ChatRoomType      @default(DIRECT)
  name          String?
  avatar        String?
  user1Id       String?
  user2Id       String?
  groupId       String?
  lastMessageAt DateTime?
  lastMessage   String?
  isActive      Boolean           @default(true)
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
  participants  ChatParticipant[]
  user1         User?             @relation("ChatRoom_user1", fields: [user1Id], references: [id])
  user2         User?             @relation("ChatRoom_user2", fields: [user2Id], references: [id])
  messages      Message[]

  @@index([user1Id])
  @@index([user2Id])
  @@index([lastMessageAt])
}

model CommentReaction {
  id          String       @id @default(cuid())
  commentId   String
  userId      String
  type        ReactionType @default(LIKE)
  createdAt   DateTime     @default(now())
  PostComment PostComment  @relation(fields: [commentId], references: [id], onDelete: Cascade)
  User        User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([commentId, userId])
  @@index([commentId])
  @@index([userId])
}

model ConversionEvent {
  id              String   @id
  userId          String
  notificationId  String?
  conversionType  String
  conversionValue Decimal?
  conversionUrl   String?
  metadata        Json?
  timestamp       DateTime @default(now())
}

model Coupon {
  id                      String    @id
  code                    String    @unique
  description             String?
  discountType            String
  discountValue           Decimal
  usageLimit              Int?
  usageCount              Int       @default(0)
  validUntil              DateTime?
  expiresAt               DateTime?
  isActive                Boolean   @default(true)
  minPurchase             Decimal?
  validFrom               DateTime?
  productIds              Json?
  membershipIds           Json?
  courseIds               Json?
  isAffiliateEnabled      Boolean   @default(false)
  isForRenewal            Boolean   @default(false)
  maxGeneratePerAffiliate Int?
  maxUsagePerCoupon       Int?
  basedOnCouponId         String?
  createdBy               String?
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @default(now()) @updatedAt
  affiliateId             String?
  generatedBy             String?
  Coupon                  Coupon?   @relation("CouponToCoupon", fields: [basedOnCouponId], references: [id], onDelete: Cascade)
  other_Coupon            Coupon[]  @relation("CouponToCoupon")

  @@index([affiliateId])
  @@index([basedOnCouponId])
  @@index([code])
  @@index([isActive])
  @@index([isAffiliateEnabled])
}

model Course {
  id                      String                 @id
  mentorId                String
  title                   String
  slug                    String?
  checkoutSlug            String?
  description             String
  thumbnail               String?
  price                   Decimal
  originalPrice           Decimal?
  mentorCommissionPercent Float                  @default(50)
  commissionType          CommissionType         @default(PERCENTAGE)
  affiliateCommissionRate Decimal                @default(30)
  affiliateEnabled        Boolean                @default(true)
  duration                Int?
  level                   String?
  status                  CourseStatus           @default(DRAFT)
  isPublished             Boolean                @default(false)
  publishedAt             DateTime?
  submittedForReviewAt    DateTime?
  reviewedBy              String?
  approvedBy              String?
  approvedAt              DateTime?
  rejectedAt              DateTime?
  rejectionReason         String?
  monetizationType        CourseMonetizationType @default(FREE)
  groupId                 String?
  reminders               Json?
  enrollmentCount         Int                    @default(0)
  rating                  Decimal                @default(0)
  formLogo                String?
  formBanner              String?
  formDescription         String?
  certificateTemplateId   String?
  mailketingListId        String?
  mailketingListName      String?
  autoAddToList           Boolean                @default(true)
  affiliateOnly           Boolean                @default(false)
  isAffiliateTraining     Boolean                @default(false)
  isAffiliateMaterial     Boolean                @default(false)
  roleAccess              CourseRoleAccess       @default(PUBLIC)
  membershipIncluded      Boolean                @default(false)
  isPublicListed          Boolean                @default(true)
  createdAt               DateTime               @default(now())
  updatedAt               DateTime
  affiliateLinks          AffiliateLink[]
}

model CourseConsent {
  id          String   @id
  courseId    String
  userId      String
  consentText String
  ipAddress   String?
  userAgent   String?
  agreedAt    DateTime @default(now())
}

model CourseMembership {
  id           String   @id
  courseId     String
  membershipId String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@unique([courseId, membershipId])
  @@index([courseId])
  @@index([membershipId])
}

model CourseDiscussion {
  id             String    @id
  courseId       String
  lessonId       String?
  title          String?
  content        String
  userId         String
  parentId       String?
  viewCount      Int       @default(0)
  likesCount     Int       @default(0)
  isMarkedSolved Boolean   @default(false)
  solvedBy       String?
  solvedAt       DateTime?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
}

model CourseEnrollment {
  id            String    @id
  courseId      String
  userId        String
  progress      Int       @default(0)
  completed     Boolean   @default(false)
  completedAt   DateTime?
  transactionId String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime
}

model CourseLesson {
  id        String   @id
  moduleId  String
  title     String
  content   String
  videoUrl  String?
  duration  Int?
  order     Int
  isFree    Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime
}

model CourseModule {
  id          String   @id
  courseId    String
  title       String
  description String?
  order       Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime
}

model CourseNote {
  id        String   @id
  userId    String
  courseId  String
  lessonId  String
  content   String
  timestamp Int?
  createdAt DateTime @default(now())
  updatedAt DateTime
}

model CourseReminder {
  id              String          @id @default(cuid())
  courseId        String
  title           String
  description     String?
  triggerType     ReminderTrigger @default(AFTER_PURCHASE)
  delayAmount     Int
  delayUnit       String          @default("days")
  specificDate    DateTime?
  preferredTime   String?
  timezone        String?         @default("Asia/Jakarta")
  avoidWeekends   Boolean         @default(false)
  daysOfWeek      Json?
  channels        Json
  emailEnabled    Boolean         @default(true)
  emailSubject    String?
  emailBody       String?
  emailCTA        String?
  emailCTALink    String?
  whatsappEnabled Boolean         @default(false)
  whatsappMessage String?
  whatsappCTA     String?
  whatsappCTALink String?
  pushEnabled     Boolean         @default(false)
  pushTitle       String?
  pushBody        String?
  pushIcon        String?
  pushClickAction String?
  inAppEnabled    Boolean         @default(false)
  inAppTitle      String?
  inAppBody       String?
  inAppLink       String?
  conditions      Json?
  stopIfCondition Json?
  sequenceOrder   Int             @default(0)
  isActive        Boolean         @default(true)
  stopOnAction    Boolean         @default(false)
  sentCount       Int             @default(0)
  deliveredCount  Int             @default(0)
  openedCount     Int             @default(0)
  clickedCount    Int             @default(0)
  failedCount     Int             @default(0)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  @@index([courseId])
  @@index([isActive])
  @@index([sequenceOrder])
  @@index([triggerType])
}

model CourseReview {
  id             String    @id
  courseId       String
  userId         String
  rating         Int
  review         String
  isVerified     Boolean   @default(false)
  isApproved     Boolean   @default(true)
  moderatedBy    String?
  moderatedAt    DateTime?
  moderationNote String?
  helpfulCount   Int       @default(0)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
}

model CourseReviewHelpful {
  id        String   @id
  reviewId  String
  userId    String
  createdAt DateTime @default(now())
}

model CourseSettings {
  id                           String   @id
  defaultMentorCommission      Float    @default(50)
  defaultAffiliateCommission   Float    @default(30)
  minWithdrawalAmount          Decimal  @default(50000)
  withdrawalProcessingDays     Int      @default(3)
  maxWithdrawalPerDay          Decimal  @default(10000000)
  withdrawalMethods            Json?
  autoApproveCourses           Boolean  @default(false)
  autoApproveEnrollments       Boolean  @default(true)
  defaultCourseVisibility      String   @default("PUBLIC")
  requireCertificateCompletion Boolean  @default(true)
  certificateMinScore          Int      @default(80)
  enableAffiliateProgram       Boolean  @default(true)
  enableMentorProgram          Boolean  @default(true)
  mentorCanCreateGroup         Boolean  @default(true)
  mentorCanCreateCourse        Boolean  @default(true)
  mentorCanCreateMaterial      Boolean  @default(true)
  mentorCanEditOwnCourse       Boolean  @default(true)
  mentorCanDeleteOwnCourse     Boolean  @default(false)
  mentorCanViewAnalytics       Boolean  @default(true)
  createdAt                    DateTime @default(now())
  updatedAt                    DateTime
}

model DocumentDownloadLog {
  id              String         @id
  userId          String
  documentId      String
  membershipLevel String
  downloadedAt    DateTime       @default(now())
  ipAddress       String?
  userAgent       String?
  status          DownloadStatus @default(SUCCESS)
  adminVerified   Boolean        @default(false)
  notes           String?
}

model Documentation {
  id              String                @id
  slug            String
  title           String
  content         String
  excerpt         String?
  category        DocumentationCategory
  targetRoles     Json
  status          DocumentationStatus   @default(DRAFT)
  isPublic        Boolean               @default(false)
  icon            String?
  order           Int                   @default(0)
  parentId        String?
  metaTitle       String?
  metaDescription String?
  keywords        String?
  featuredImage   String?
  publishedAt     DateTime?
  archivedAt      DateTime?
  viewCount       Int                   @default(0)
  authorId        String
  lastEditedById  String?
  createdAt       DateTime              @default(now())
  updatedAt       DateTime
}

model DocumentationRevision {
  id              String   @id
  documentationId String
  content         String
  title           String
  excerpt         String?
  changedById     String
  changeNote      String?
  version         Int
  createdAt       DateTime @default(now())
}

model EmailTemplate {
  id         String   @id
  name       String
  category   String?
  roleTarget String?
  subject    String
  body       String
  ctaText    String?
  ctaLink    String?
  variables  Json?
  metadata   Json?
  usageCount Int      @default(0)
  isActive   Boolean  @default(true)
  createdAt  DateTime @default(now())
  updatedAt  DateTime
}

model EmailVerificationToken {
  id         String   @id
  identifier String
  token      String
  expires    DateTime
  type       String?  @default("EMAIL_VERIFY")
  metadata   String?
  createdAt  DateTime @default(now())
}

model Event {
  id              String          @id
  creatorId       String
  groupId         String?
  title           String
  description     String
  thumbnail       String?
  type            EventType
  startDate       DateTime
  endDate         DateTime
  location        String?
  meetingUrl      String?
  meetingId       String?
  meetingPassword String?
  recordingUrl    String?
  maxAttendees    Int?
  price           Decimal?        @default(0)
  commissionType  CommissionType?
  commissionRate  Decimal?
  isPublished     Boolean         @default(false)
  isFeatured      Boolean         @default(false)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime
}

model EventGroup {
  id        String   @id
  productId String
  groupId   String
  createdAt DateTime @default(now())
}

model EventMembership {
  id           String   @id
  productId    String
  membershipId String
  createdAt    DateTime @default(now())
}

model EventRSVP {
  id            String    @id
  eventId       String
  userId        String
  status        String    @default("GOING")
  attended      Boolean   @default(false)
  isPaid        Boolean   @default(false)
  paidAt        DateTime?
  transactionId String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime
}

model EventReminder {
  id              String          @id @default(cuid())
  eventId         String
  title           String
  description     String?
  triggerType     ReminderTrigger @default(BEFORE_EXPIRY)
  delayAmount     Int
  delayUnit       String          @default("days")
  specificDate    DateTime?
  preferredTime   String?
  timezone        String?         @default("Asia/Jakarta")
  avoidWeekends   Boolean         @default(false)
  daysOfWeek      Json?
  channels        Json
  emailEnabled    Boolean         @default(true)
  emailSubject    String?
  emailBody       String?
  emailCTA        String?
  emailCTALink    String?
  whatsappEnabled Boolean         @default(false)
  whatsappMessage String?
  whatsappCTA     String?
  whatsappCTALink String?
  pushEnabled     Boolean         @default(false)
  pushTitle       String?
  pushBody        String?
  pushIcon        String?
  pushClickAction String?
  inAppEnabled    Boolean         @default(false)
  inAppTitle      String?
  inAppBody       String?
  inAppLink       String?
  conditions      Json?
  stopIfCondition Json?
  sequenceOrder   Int             @default(0)
  isActive        Boolean         @default(true)
  stopOnAction    Boolean         @default(false)
  sentCount       Int             @default(0)
  deliveredCount  Int             @default(0)
  openedCount     Int             @default(0)
  clickedCount    Int             @default(0)
  failedCount     Int             @default(0)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  @@index([eventId])
  @@index([isActive])
  @@index([sequenceOrder])
  @@index([triggerType])
}

model Expense {
  id          String    @id
  adminId     String
  title       String
  description String?
  amount      Decimal
  category    String
  paidBy      String?
  paidAt      DateTime  @default(now())
  receipt     String?
  isApproved  Boolean   @default(false)
  approvedBy  String?
  approvedAt  DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime
}

model ExportDocument {
  id             String   @id
  name           String
  slug           String
  type           String
  description    String?
  templateHtml   String
  templateFields Json
  category       String?  @default("OTHER")
  paperSize      String   @default("A4")
  orientation    String   @default("portrait")
  thumbnail      String?
  isActive       Boolean  @default(true)
  isPremium      Boolean  @default(false)
  isBuiltIn      Boolean  @default(true)
  usageCount     Int      @default(0)
  createdBy      String
  createdAt      DateTime @default(now())
  updatedAt      DateTime
}

model Follow {
  id                            String   @id
  followerId                    String
  followingId                   String
  createdAt                     DateTime @default(now())
  User_Follow_followerIdToUser  User     @relation("Follow_followerIdToUser", fields: [followerId], references: [id], onDelete: Cascade)
  User_Follow_followingIdToUser User     @relation("Follow_followingIdToUser", fields: [followingId], references: [id], onDelete: Cascade)

  @@unique([followerId, followingId])
  @@index([followerId])
  @@index([followingId])
}

model FollowUpLog {
  id            String          @id
  followUpId    String
  affiliateId   String
  leadEmail     String
  leadName      String?
  leadPhone     String?
  channel       ReminderChannel @default(EMAIL)
  status        ReminderStatus  @default(SENT)
  sentAt        DateTime        @default(now())
  transactionId String?
  notes         String?
  createdAt     DateTime        @default(now())

  @@index([affiliateId])
  @@index([followUpId])
  @@index([leadEmail])
  @@index([sentAt])
}

model FollowUpTemplate {
  id            String   @id
  name          String
  triggerHours  Int
  message       String
  channel       String
  isActive      Boolean  @default(true)
  createdBy     String
  ownerId       String?
  ownerType     String   @default("admin")
  useMailkiting Boolean  @default(false)
  useStarsender Boolean  @default(false)
  useOnesignal  Boolean  @default(false)
  usePusher     Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime
}

model Forwarder {
  id             String    @id
  companyName    String
  country        String    @default("Indonesia")
  city           String
  address        String?
  contactPerson  String?
  email          String?
  phone          String?
  whatsapp       String?
  website        String?
  serviceType    String?
  routes         String?
  services       String?
  priceRange     String?
  minShipment    String?
  isVerified     Boolean   @default(false)
  verifiedBy     String?
  verifiedAt     DateTime?
  rating         Float?    @default(0)
  totalShipments Int       @default(0)
  tags           String?
  notes          String?
  addedBy        String
  viewCount      Int       @default(0)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
}

model ForwarderView {
  id          String   @id
  userId      String
  forwarderId String
  viewedAt    DateTime @default(now())
}

model GeneratedDocument {
  id           String   @id
  userId       String
  templateId   String
  documentData Json
  documentHtml String
  documentPdf  String?
  title        String
  documentNo   String?
  notes        String?
  status       String   @default("DRAFT")
  createdAt    DateTime @default(now())
  updatedAt    DateTime
}

model Group {
  id              String    @id
  name            String
  description     String
  avatar          String?
  coverImage      String?
  type            GroupType @default(PUBLIC)
  ownerId         String
  bannedWords     Json?
  requireApproval Boolean   @default(false)
  isActive        Boolean   @default(true)
  postingSettings Json?
  allowRichText   Boolean   @default(true)
  allowMedia      Boolean   @default(true)
  allowPolls      Boolean   @default(true)
  allowEvents     Boolean   @default(true)
  allowScheduling Boolean   @default(true)
  allowReactions  Boolean   @default(true)
  allowMentions   Boolean   @default(true)
  moderatesPosts  Boolean   @default(false)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime
  slug            String?   @unique
  Product         Product[]
}

model GroupChallenge {
  id            String   @id
  groupId       String
  title         String
  description   String?
  type          String
  target        Int?
  startDate     DateTime
  endDate       DateTime
  rewardPoints  Int      @default(50)
  rewardBadgeId String?
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime
}

model GroupMember {
  id       String    @id
  groupId  String
  userId   String
  role     GroupRole @default(MEMBER)
  joinedAt DateTime  @default(now())
}

model GroupQuiz {
  id               String    @id
  groupId          String
  creatorId        String
  title            String
  description      String?
  coverImage       String?
  passingScore     Int       @default(70)
  timeLimit        Int?
  maxAttempts      Int       @default(1)
  shuffleQuestions Boolean   @default(true)
  shuffleOptions   Boolean   @default(true)
  showResults      Boolean   @default(true)
  isActive         Boolean   @default(true)
  startDate        DateTime?
  endDate          DateTime?
  rewardPoints     Int       @default(10)
  rewardBadgeId    String?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime
}

model GroupQuizAnswer {
  id             String   @id
  attemptId      String
  questionId     String
  selectedOption String?
  isCorrect      Boolean  @default(false)
  pointsEarned   Int      @default(0)
  createdAt      DateTime @default(now())
}

model GroupQuizAttempt {
  id          String    @id
  quizId      String
  userId      String
  score       Int       @default(0)
  maxScore    Int       @default(0)
  percentage  Float     @default(0)
  isPassed    Boolean   @default(false)
  isCompleted Boolean   @default(false)
  startedAt   DateTime  @default(now())
  completedAt DateTime?
  timeSpent   Int?
}

model GroupQuizQuestion {
  id           String       @id
  quizId       String
  question     String
  questionType QuestionType @default(MULTIPLE_CHOICE)
  options      Json
  explanation  String?
  points       Int          @default(1)
  order        Int          @default(0)
  imageUrl     String?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime
}

model GroupResource {
  id            String   @id
  groupId       String
  uploaderId    String
  title         String
  description   String?
  fileUrl       String
  fileName      String
  fileType      String
  fileSize      Int
  downloadCount Int      @default(0)
  createdAt     DateTime @default(now())
}

model Integration {
  id        String   @id
  name      String
  isEnabled Boolean  @default(false)
  config    Json
  createdAt DateTime @default(now())
  updatedAt DateTime
}

model IntegrationConfig {
  id           String    @id
  service      String    @unique
  config       Json
  isActive     Boolean   @default(false)
  lastTestedAt DateTime?
  testStatus   String?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime
}

model LessonFile {
  id        String   @id
  lessonId  String
  title     String
  fileName  String
  fileUrl   String
  fileSize  Int?
  fileType  String?
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime
}

model Membership {
  id                      String             @id
  name                    String
  slug                    String?            @unique
  checkoutSlug            String?            @unique
  checkoutTemplate        String?            @default("modern")
  description             String
  duration                MembershipDuration
  price                   Decimal
  originalPrice           Decimal?
  discount                Int                @default(0)
  commissionType          CommissionType     @default(PERCENTAGE)
  affiliateCommissionRate Decimal            @default(30)
  features                Json
  isBestSeller            Boolean            @default(false)
  isPopular               Boolean            @default(false)
  isMostPopular           Boolean            @default(false)
  marketingBadge          MarketingBadge?
  isActive                Boolean            @default(true)
  status                  MembershipStatus   @default(PUBLISHED)
  salesPageUrl            String?
  alternativeUrl          String?
  reminders               Json?
  formLogo                String?
  formBanner              String?
  formDescription         String?
  mailketingListId        String?
  mailketingListName      String?
  autoAddToList           Boolean            @default(true)
  autoRemoveOnExpire      Boolean            @default(false)
  showInGeneralCheckout   Boolean            @default(true)
  affiliateEnabled        Boolean            @default(true)
  createdAt               DateTime           @default(now())
  updatedAt               DateTime
  affiliateLinks          AffiliateLink[]

  @@index([affiliateEnabled])
  @@index([duration])
  @@index([isActive])
  @@index([status])
}

model MembershipCourse {
  id           String   @id
  membershipId String
  courseId     String
  createdAt    DateTime @default(now())

  @@unique([membershipId, courseId])
  @@index([courseId])
  @@index([membershipId])
}

model MembershipDocument {
  id            String   @id
  title         String
  description   String?
  category      String
  fileUrl       String
  fileName      String
  fileSize      Int
  fileType      String
  minimumLevel  String
  uploaderId    String
  isActive      Boolean  @default(true)
  viewCount     Int      @default(0)
  downloadCount Int      @default(0)
  createdAt     DateTime @default(now())
  updatedAt     DateTime
}

model MembershipFeatureAccess {
  id           String   @id
  membershipId String
  featureKey   String
  enabled      Boolean  @default(true)
  value        Json?
  createdAt    DateTime @default(now())
  updatedAt    DateTime

  @@unique([membershipId, featureKey])
  @@index([featureKey])
  @@index([membershipId])
}

model MembershipFollowUp {
  id              String   @id
  membershipId    String
  title           String
  description     String?
  emailSubject    String
  emailBody       String
  emailCTA        String?
  emailCTALink    String?
  whatsappMessage String?
  shortcodes      Json?
  sequenceOrder   Int      @default(0)
  isActive        Boolean  @default(true)
  usageCount      Int      @default(0)
  createdAt       DateTime @default(now())
  updatedAt       DateTime

  @@unique([membershipId, title])
  @@index([isActive])
  @@index([membershipId])
  @@index([sequenceOrder])
}

model MembershipGroup {
  id           String   @id
  membershipId String
  groupId      String
  createdAt    DateTime @default(now())

  @@unique([membershipId, groupId])
  @@index([groupId])
  @@index([membershipId])
}

model MembershipProduct {
  id           String   @id
  membershipId String
  productId    String
  createdAt    DateTime @default(now())

  @@unique([membershipId, productId])
  @@index([membershipId])
  @@index([productId])
}

model MembershipReminder {
  id              String          @id @default(cuid())
  membershipId    String
  title           String
  description     String?
  triggerType     ReminderTrigger @default(AFTER_PURCHASE)
  delayAmount     Int
  delayUnit       String          @default("days")
  specificDate    DateTime?
  preferredTime   String?
  timezone        String?         @default("Asia/Jakarta")
  avoidWeekends   Boolean         @default(false)
  daysOfWeek      Json?
  channels        Json
  emailEnabled    Boolean         @default(true)
  emailSubject    String?
  emailBody       String?
  emailCTA        String?
  emailCTALink    String?
  whatsappEnabled Boolean         @default(false)
  whatsappMessage String?
  whatsappCTA     String?
  whatsappCTALink String?
  pushEnabled     Boolean         @default(false)
  pushTitle       String?
  pushBody        String?
  pushIcon        String?
  pushClickAction String?
  inAppEnabled    Boolean         @default(false)
  inAppTitle      String?
  inAppBody       String?
  inAppLink       String?
  conditions      Json?
  stopIfCondition Json?
  sequenceOrder   Int             @default(0)
  isActive        Boolean         @default(true)
  stopOnAction    Boolean         @default(false)
  sentCount       Int             @default(0)
  deliveredCount  Int             @default(0)
  openedCount     Int             @default(0)
  clickedCount    Int             @default(0)
  failedCount     Int             @default(0)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  @@unique([membershipId, title])
  @@index([isActive])
  @@index([membershipId])
  @@index([sequenceOrder])
  @@index([triggerType])
}

model MembershipUpgradeLog {
  id               String   @id
  userId           String
  oldMembershipId  String?
  newMembershipId  String
  upgradeDate      DateTime @default(now())
  paymentMode      String
  oldPlanRemaining Int?
  pricePaid        Decimal
  notes            String?
}

model MentorProfile {
  id             String    @id
  userId         String    @unique
  expertise      String?
  bio            String?
  commissionRate Decimal   @default(30)
  totalStudents  Int       @default(0)
  totalCourses   Int       @default(0)
  totalEarnings  Decimal   @default(0)
  rating         Decimal   @default(0)
  isActive       Boolean   @default(true)
  verifiedAt     DateTime?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime

  @@index([userId])
}

model Message {
  id             String    @id @default(cuid())
  roomId         String?
  senderId       String
  receiverId     String?
  content        String
  type           String    @default("text")
  attachmentUrl  String?
  attachmentType String?
  isRead         Boolean   @default(false)
  readAt         DateTime?
  isDelivered    Boolean   @default(false)
  deliveredAt    DateTime?
  reactions      Json?
  replyToId      String?
  isEdited       Boolean   @default(false)
  isDeleted      Boolean   @default(false)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
  attachmentName String?
  attachmentSize Int?
  metadata       Json?
  room           ChatRoom? @relation(fields: [roomId], references: [id], onDelete: Cascade)
  sender         User      @relation("Message_sender", fields: [senderId], references: [id], onDelete: Cascade)

  @@index([roomId])
  @@index([senderId])
  @@index([receiverId])
  @@index([createdAt])
  @@index([isDeleted])
  @@index([isRead])
}

model Notification {
  id            String           @id
  userId        String
  type          NotificationType
  title         String
  message       String
  sourceType    String?
  sourceId      String?
  postId        String?
  commentId     String?
  eventId       String?
  courseId      String?
  groupId       String?
  transactionId String?
  link          String?
  redirectUrl   String?
  image         String?
  icon          String?
  channels      Json?
  isRead        Boolean          @default(false)
  readAt        DateTime?
  isSent        Boolean          @default(false)
  sentAt        DateTime?
  isDelivered   Boolean          @default(false)
  deliveredAt   DateTime?
  isClicked     Boolean          @default(false)
  clickedAt     DateTime?
  metadata      Json?
  actorId       String?
  actorName     String?
  actorAvatar   String?
  createdAt     DateTime         @default(now())
  updatedAt     DateTime
}

model NotificationConsent {
  id                  String    @id
  userId              String
  consentGiven        Boolean   @default(true)
  channels            Json
  purpose             String    @default("marketing")
  ipAddress           String?
  userAgent           String?
  consentTimestamp    DateTime  @default(now())
  consentExpiry       DateTime
  revocationTimestamp DateTime?
  revocationReason    String?
}

model NotificationDeliveryLog {
  id             String    @id
  notificationId String
  playerId       String
  userId         String?
  status         String    @default("delivered")
  platform       String?
  openedAt       DateTime?
  clickedAt      DateTime?
  clickUrl       String?
  ipAddress      String?
  userAgent      String?
  bounceReason   String?
  timestamp      DateTime  @default(now())
}

model NotificationPreference {
  id                       String   @id
  userId                   String
  enableAllEmail           Boolean  @default(true)
  enableAllWhatsApp        Boolean  @default(false)
  enableAllPush            Boolean  @default(true)
  enableAllInApp           Boolean  @default(true)
  chatNotifications        Boolean  @default(true)
  commentNotifications     Boolean  @default(true)
  postNotifications        Boolean  @default(true)
  courseNotifications      Boolean  @default(true)
  eventNotifications       Boolean  @default(true)
  transactionNotifications Boolean  @default(true)
  followerNotifications    Boolean  @default(true)
  achievementNotifications Boolean  @default(true)
  systemNotifications      Boolean  @default(true)
  affiliateNotifications   Boolean  @default(true)
  enableQuietHours         Boolean  @default(false)
  quietHoursStart          String?
  quietHoursEnd            String?
  createdAt                DateTime @default(now())
  updatedAt                DateTime
}

model NotificationSubscription {
  id               String   @id
  userId           String
  subscriptionType String
  targetId         String
  enableEmail      Boolean  @default(true)
  enableWhatsApp   Boolean  @default(false)
  enablePush       Boolean  @default(true)
  enableInApp      Boolean  @default(true)
  isAutoSubscribed Boolean  @default(true)
  createdAt        DateTime @default(now())
  updatedAt        DateTime
}

model OneSignalAutoNotification {
  id           String   @id
  name         String
  trigger      String
  title        String
  message      String
  url          String?
  enabled      Boolean  @default(true)
  delayMinutes Int      @default(0)
  targetType   String   @default("user")
  createdAt    DateTime @default(now())
  updatedAt    DateTime
}

model OneSignalTemplate {
  id          String   @id
  name        String
  title       String
  message     String
  url         String?
  imageUrl    String?
  targetType  String   @default("all")
  targetValue String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime
}

model OneSignalWebhookLog {
  id               String    @id
  eventType        String
  payload          Json
  processingStatus String    @default("pending")
  errorMessage     String?
  retryCount       Int       @default(0)
  lastRetryAt      DateTime?
  processedAt      DateTime?
  timestamp        DateTime  @default(now())
}

model PasswordResetToken {
  id        String    @id
  email     String
  token     String    @unique
  expiresAt DateTime
  createdAt DateTime  @default(now())
  used      Boolean   @default(false)
  usedAt    DateTime?

  @@index([email])
  @@index([expiresAt])
}

model Payout {
  id            String       @id
  walletId      String
  amount        Decimal
  status        PayoutStatus @default(PENDING)
  bankName      String?
  accountName   String?
  accountNumber String?
  notes         String?
  approvedBy    String?
  approvedAt    DateTime?
  paidAt        DateTime?
  createdAt     DateTime     @default(now())
  updatedAt     DateTime

  @@index([status])
  @@index([walletId])
}

model PendingRevenue {
  id             String    @id
  walletId       String
  transactionId  String
  amount         Decimal
  type           String
  percentage     Decimal
  status         String    @default("PENDING")
  adjustedAmount Decimal?
  adjustmentNote String?
  approvedBy     String?
  approvedAt     DateTime?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime

  @@index([status])
  @@index([transactionId])
  @@index([walletId])
}

model PointTransaction {
  id          String   @id
  userId      String
  groupId     String?
  points      Int
  type        String
  sourceId    String?
  description String?
  createdAt   DateTime @default(now())
}

model Post {
  id               String         @id
  authorId         String
  groupId          String?
  type             PostType       @default(POST)
  content          String
  contentFormatted Json?
  backgroundId     String?
  images           Json?
  videos           Json?
  documents        Json?
  linkPreview      Json?
  location         Json?
  pollData         Json?
  eventData        Json?
  quoteStyle       Json?
  taggedUsers      Json?
  metadata         Json?
  isPinned         Boolean        @default(false)
  isScheduled      Boolean        @default(false)
  scheduledAt      DateTime?
  commentsEnabled  Boolean        @default(true)
  approvalStatus   ApprovalStatus @default(APPROVED)
  likesCount       Int            @default(0)
  commentsCount    Int            @default(0)
  sharesCount      Int            @default(0)
  reactionsCount   Json?
  expiresAt        DateTime?
  createdAt        DateTime       @default(now())
  updatedAt        DateTime
  User             User           @relation(fields: [authorId], references: [id], onDelete: Cascade)
  PostComment      PostComment[]
  PostReaction     PostReaction[]
  SavedPost        SavedPost[]

  @@index([authorId])
  @@index([createdAt])
  @@index([groupId])
}

model PostComment {
  id                String            @id @default(cuid())
  postId            String
  userId            String
  content           String
  parentId          String?
  createdAt         DateTime          @default(now())
  updatedAt         DateTime          @updatedAt
  contentFormatted  Json?
  images            Json?
  mentionedUsers    Json?
  reactionsCount    Json?
  CommentReaction   CommentReaction[]
  PostComment       PostComment?      @relation("PostCommentToPostComment", fields: [parentId], references: [id], onDelete: Cascade)
  other_PostComment PostComment[]     @relation("PostCommentToPostComment")
  Post              Post              @relation(fields: [postId], references: [id], onDelete: Cascade)
  User              User              @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([parentId])
  @@index([postId])
  @@index([userId])
}

model PostLike {
  id        String   @id @default(cuid())
  postId    String
  userId    String
  createdAt DateTime @default(now())
}

model PostReaction {
  id        String       @id @default(cuid())
  postId    String
  userId    String
  type      ReactionType @default(LIKE)
  createdAt DateTime     @default(now())
  Post      Post         @relation(fields: [postId], references: [id], onDelete: Cascade)
  User      User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([postId, userId])
  @@index([postId])
  @@index([userId])
}

model Product {
  id                      String          @id
  creatorId               String
  name                    String
  slug                    String?
  checkoutSlug            String?
  description             String
  shortDescription        String?
  price                   Decimal
  originalPrice           Decimal?
  thumbnail               String?
  images                  Json?
  salesPageUrl            String?
  externalSalesUrl        String?
  reminders               Json?
  category                String?
  tags                    Json?
  productType             ProductType     @default(DIGITAL)
  productStatus           ProductStatus   @default(DRAFT)
  accessLevel             AccessLevel     @default(PUBLIC)
  eventDate               DateTime?
  eventEndDate            DateTime?
  eventDuration           Int?
  eventUrl                String?
  meetingId               String?
  meetingPassword         String?
  eventVisibility         EventVisibility @default(PUBLIC)
  eventPassword           String?
  maxParticipants         Int?
  reminderSent7Days       Boolean         @default(false)
  reminderSent3Days       Boolean         @default(false)
  reminderSent1Day        Boolean         @default(false)
  reminderSent1Hour       Boolean         @default(false)
  reminderSent15Min       Boolean         @default(false)
  enableUpsale            Boolean         @default(true)
  upsaleTargetMemberships String?
  upsaleDiscount          Int             @default(0)
  upsaleMessage           String?
  commissionType          CommissionType  @default(PERCENTAGE)
  affiliateCommissionRate Decimal         @default(30)
  affiliateEnabled        Boolean         @default(true)
  mentorCommission        Decimal         @default(30)
  groupId                 String?
  isActive                Boolean         @default(true)
  isFeatured              Boolean         @default(false)
  stock                   Int?
  soldCount               Int             @default(0)
  formLogo                String?
  formBanner              String?
  formDescription         String?
  mailketingListId        String?
  mailketingListName      String?
  autoAddToList           Boolean         @default(true)
  seoMetaTitle            String?
  seoMetaDescription      String?
  seoKeywords             String?
  ctaButtonText           String?
  faqs                    Json?
  testimonials            Json?
  bonuses                 Json?
  downloadableFiles       Json?
  trackingPixels          Json?
  viewCount               Int             @default(0)
  clickCount              Int             @default(0)
  createdAt               DateTime        @default(now())
  updatedAt               DateTime
  affiliateLinks          AffiliateLink[]
  User                    User            @relation(fields: [creatorId], references: [id], onDelete: Cascade)
  Group                   Group?          @relation(fields: [groupId], references: [id])
  UserProduct             UserProduct[]
}

model ProductCourse {
  id        String   @id
  productId String
  courseId  String
  createdAt DateTime @default(now())
}

model ProductReminder {
  id              String          @id @default(cuid())
  productId       String
  title           String
  description     String?
  triggerType     ReminderTrigger @default(AFTER_PURCHASE)
  delayAmount     Int
  delayUnit       String          @default("days")
  specificDate    DateTime?
  preferredTime   String?
  timezone        String?         @default("Asia/Jakarta")
  avoidWeekends   Boolean         @default(false)
  daysOfWeek      Json?
  channels        Json
  emailEnabled    Boolean         @default(true)
  emailSubject    String?
  emailBody       String?
  emailCTA        String?
  emailCTALink    String?
  whatsappEnabled Boolean         @default(false)
  whatsappMessage String?
  whatsappCTA     String?
  whatsappCTALink String?
  pushEnabled     Boolean         @default(false)
  pushTitle       String?
  pushBody        String?
  pushIcon        String?
  pushClickAction String?
  inAppEnabled    Boolean         @default(false)
  inAppTitle      String?
  inAppBody       String?
  inAppLink       String?
  conditions      Json?
  stopIfCondition Json?
  sequenceOrder   Int             @default(0)
  isActive        Boolean         @default(true)
  stopOnAction    Boolean         @default(false)
  sentCount       Int             @default(0)
  deliveredCount  Int             @default(0)
  openedCount     Int             @default(0)
  clickedCount    Int             @default(0)
  failedCount     Int             @default(0)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  @@unique([productId, title])
  @@index([isActive])
  @@index([productId])
  @@index([sequenceOrder])
  @@index([triggerType])
}

model Quiz {
  id               String   @id
  courseId         String
  lessonId         String?
  title            String
  description      String?
  passingScore     Int      @default(70)
  timeLimit        Int?
  maxAttempts      Int?
  shuffleQuestions Boolean  @default(false)
  shuffleAnswers   Boolean  @default(false)
  showResults      Boolean  @default(true)
  isActive         Boolean  @default(true)
  createdAt        DateTime @default(now())
  updatedAt        DateTime
}

model QuizAnswer {
  id             String    @id
  attemptId      String
  questionId     String
  selectedOption String?
  textAnswer     String?
  isCorrect      Boolean   @default(false)
  pointsEarned   Int       @default(0)
  isGraded       Boolean   @default(false)
  gradedBy       String?
  gradedAt       DateTime?
  feedback       String?
  createdAt      DateTime  @default(now())
}

model QuizAttempt {
  id          String    @id
  quizId      String
  userId      String
  score       Int       @default(0)
  maxScore    Int
  earnedScore Int       @default(0)
  isPassed    Boolean   @default(false)
  isCompleted Boolean   @default(false)
  startedAt   DateTime  @default(now())
  completedAt DateTime?
  timeSpent   Int?
}

model QuizQuestion {
  id            String       @id
  quizId        String
  type          QuestionType @default(MULTIPLE_CHOICE)
  question      String
  explanation   String?
  points        Int          @default(1)
  order         Int
  options       Json?
  correctAnswer String?
  createdAt     DateTime     @default(now())
  updatedAt     DateTime
}

model ReminderLog {
  id           String          @id @default(cuid())
  reminderId   String
  userId       String
  channel      ReminderChannel
  status       ReminderStatus  @default(PENDING)
  scheduledAt  DateTime
  sentAt       DateTime?
  deliveredAt  DateTime?
  openedAt     DateTime?
  clickedAt    DateTime?
  failedAt     DateTime?
  subject      String?
  body         String?
  ctaLink      String?
  errorMessage String?
  ipAddress    String?
  userAgent    String?
  deviceInfo   Json?
  mailketingId String?
  whatsappId   String?
  pushId       String?
  createdAt    DateTime        @default(now())
  updatedAt    DateTime        @updatedAt

  @@index([channel])
  @@index([reminderId])
  @@index([scheduledAt])
  @@index([sentAt])
  @@index([status])
  @@index([userId])
}

model ReminderTemplate {
  id           String   @id @default(cuid())
  name         String
  description  String?
  category     String?
  templateData Json
  isPublic     Boolean  @default(false)
  createdBy    String
  usageCount   Int      @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([category])
  @@index([createdBy])
}

model Report {
  id           String       @id
  reporterId   String
  type         ReportType
  reason       String
  description  String?
  postId       String?
  commentId    String?
  userId       String?
  groupId      String?
  status       ReportStatus @default(PENDING)
  reviewedById String?
  reviewedAt   DateTime?
  reviewNote   String?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime
}

model SalesPageSettings {
  id                   String   @id
  heroTitle            String?  @default("Belajar Ekspor Mudah dan Praktis di Komunitas")
  heroHighlight        String?  @default("Mudah dan Praktis")
  heroDescription      String?  @default("Dibimbing langsung oleh praktisi ekspor berpengalaman. Mulai dari persiapan dokumen, mencari buyer, hingga pengiriman barang ke luar negeri.")
  heroBadgeText        String?  @default("7,000+ Calon Eksportir Bergabung")
  heroCtaText          String?  @default("Mulai Belajar Sekarang")
  heroCtaSecondaryText String?  @default("Lihat Fitur")
  navbarLogo           String?
  navbarLogoText       String?  @default("Eksporyuk")
  navbarCtaText        String?  @default("Gabung Komunitas")
  featuresTitle        String?  @default("Semua yang Anda Butuhkan untuk Sukses Ekspor")
  featuresSubtitle     String?  @default("Platform lengkap untuk belajar dan praktik ekspor dengan bimbingan mentor berpengalaman")
  featuresData         Json?
  pricingTitle         String?  @default("Pilih Paket Membership Anda")
  pricingSubtitle      String?  @default("Investasi terbaik untuk masa depan bisnis ekspor Anda")
  pricingShowFromDb    Boolean  @default(true)
  pricingCustomData    Json?
  testimonialsTitle    String?  @default("Apa Kata Mereka?")
  testimonialsSubtitle String?  @default("Kisah sukses dari member yang telah berhasil ekspor")
  testimonialsData     Json?
  faqTitle             String?  @default("Pertanyaan yang Sering Ditanyakan")
  faqData              Json?
  ctaTitle             String?  @default("Siap Memulai Perjalanan Ekspor Anda?")
  ctaDescription       String?  @default("Bergabung sekarang dan dapatkan akses ke materi ekslusif serta bimbingan dari mentor berpengalaman.")
  ctaButtonText        String?  @default("Gabung Komunitas Sekarang!")
  ctaStats             Json?
  footerDescription    String?  @default("Platform edukasi ekspor #1 di Indonesia untuk membantu UMKM go international.")
  footerEmail          String?  @default("info@eksporyuk.com")
  footerPhone          String?  @default("+62 812-3456-7890")
  footerAddress        String?
  footerSocialLinks    Json?
  createdAt            DateTime @default(now())
  updatedAt            DateTime
}

model SavedPost {
  id        String   @id @default(cuid())
  postId    String
  userId    String
  createdAt DateTime @default(now())
  Post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)
  User      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([postId, userId])
  @@index([postId])
  @@index([userId])
}

model ScheduledPost {
  id               String   @id
  authorId         String
  groupId          String
  content          String
  contentFormatted Json?
  images           Json?
  videos           Json?
  documents        Json?
  type             PostType @default(POST)
  scheduledAt      DateTime
  timezone         String   @default("Asia/Jakarta")
  status           String   @default("PENDING")
  publishedPostId  String?
  errorMessage     String?
  createdAt        DateTime @default(now())
  updatedAt        DateTime
}

model Settings {
  id                              Int      @id @default(autoincrement())
  revenueEnabled                  Boolean  @default(true)
  affiliateCommissionEnabled      Boolean  @default(true)
  mentorCommissionEnabled         Boolean  @default(true)
  paymentExpiryHours              Int      @default(72)
  followUpEnabled                 Boolean  @default(true)
  followUp1HourEnabled            Boolean  @default(true)
  followUp24HourEnabled           Boolean  @default(true)
  followUp48HourEnabled           Boolean  @default(true)
  followUpMessage1Hour            String?  @default("Halo {name}, pembayaran Anda sebesar Rp {amount} masih menunggu. Segera selesaikan dalam {timeLeft}. Link: {paymentUrl}")
  followUpMessage24Hour           String?  @default("Reminder: Pembayaran Anda akan kadaluarsa dalam {timeLeft}. Segera bayar sebelum terlambat!")
  followUpMessage48Hour           String?  @default("Last chance! Pembayaran Anda akan dibatalkan otomatis jika tidak diselesaikan dalam {timeLeft}.")
  mailkitingEnabled               Boolean  @default(false)
  mailkitingApiKey                String?
  starsenderEnabled               Boolean  @default(false)
  starsenderApiKey                String?
  onesignalEnabled                Boolean  @default(false)
  onesignalAppId                  String?
  onesignalApiKey                 String?
  pusherEnabled                   Boolean  @default(false)
  pusherAppId                     String?
  pusherKey                       String?
  pusherSecret                    String?
  pusherCluster                   String?  @default("ap1")
  challengeRewardAutoApprove      Boolean  @default(false)
  challengeRewardAutoApproveLimit Decimal? @default(500000)
  affiliateAutoApprove            Boolean  @default(false)
  siteTitle                       String?  @default("Eksporyuk")
  siteDescription                 String?  @default("Platform Ekspor Indonesia")
  siteLogo                        String?
  siteFavicon                     String?
  primaryColor                    String?  @default("#0066CC")
  secondaryColor                  String?  @default("#0052CC")
  buttonPrimaryBg                 String?  @default("#0066CC")
  buttonPrimaryText               String?  @default("#FFFFFF")
  buttonSecondaryBg               String?  @default("#6B7280")
  buttonSecondaryText             String?  @default("#FFFFFF")
  buttonSuccessBg                 String?  @default("#10B981")
  buttonSuccessText               String?  @default("#FFFFFF")
  buttonDangerBg                  String?  @default("#EF4444")
  buttonDangerText                String?  @default("#FFFFFF")
  buttonBorderRadius              String?  @default("0.5rem")
  headerText                      String?
  footerText                      String?
  contactEmail                    String?
  contactPhone                    String?
  whatsappNumber                  String?
  withdrawalMinAmount             Decimal? @default(50000)
  withdrawalAdminFee              Decimal? @default(5000)
  withdrawalPinRequired           Boolean  @default(true)
  withdrawalPinLength             Int      @default(6)
  instagramUrl                    String?
  facebookUrl                     String?
  linkedinUrl                     String?
  customCss                       String?
  customJs                        String?
  maintenanceMode                 Boolean  @default(false)
  defaultLanguage                 String?  @default("id")
  bannerImage                     String?
  paymentBankAccounts             Json?    @default("[]")
  paymentXenditChannels           Json?    @default("[]")
  paymentEnableManual             Boolean  @default(true)
  paymentEnableXendit             Boolean  @default(true)
  paymentSandboxMode              Boolean  @default(false)
  paymentAutoActivation           Boolean  @default(true)
  paymentMinAmount                Int      @default(10000)
  paymentMaxAmount                Int      @default(100000000)
  createdAt                       DateTime @default(now())
  updatedAt                       DateTime
  emailFooterAddress              String?
  emailFooterCompany              String?
  emailFooterEmail                String?
  emailFooterPhone                String?
  emailFooterText                 String?
  emailFooterCopyrightText        String?
  emailFooterFacebookUrl          String?
  emailFooterInstagramUrl         String?
  emailFooterLinkedinUrl          String?
  emailFooterWebsiteUrl           String?
  checkoutAccentColor             String?  @default("#60a5fa")
  checkoutPrimaryColor            String?  @default("#3b82f6")
  checkoutSecondaryColor          String?  @default("#1e40af")
  checkoutSuccessColor            String?  @default("#22c55e")
  checkoutWarningColor            String?  @default("#eab308")
  dashboardSidebarBg              String?  @default("#1e293b")
  dashboardSidebarText            String?  @default("#e2e8f0")
  dashboardSidebarActiveText      String?  @default("#ffffff")
  dashboardSidebarActiveBg        String?  @default("#3b82f6")
  dashboardSidebarHoverBg         String?  @default("#334155")
  dashboardHeaderBg               String?  @default("#ffffff")
  dashboardHeaderText             String?  @default("#1f2937")
  dashboardBodyBg                 String?  @default("#f1f5f9")
  dashboardCardBg                 String?  @default("#ffffff")
  dashboardCardBorder             String?  @default("#e2e8f0")
  dashboardCardHeaderBg           String?  @default("#f8fafc")
  dashboardTextPrimary            String?  @default("#1f2937")
  dashboardTextSecondary          String?  @default("#64748b")
  dashboardTextMuted              String?  @default("#94a3b8")
  dashboardBorderColor            String?  @default("#e2e8f0")
  dashboardSuccessColor           String?  @default("#22c55e")
  dashboardWarningColor           String?  @default("#f59e0b")
  dashboardDangerColor            String?  @default("#ef4444")
  dashboardInfoColor              String?  @default("#3b82f6")
  logoAffiliate                   String?
  brandName                       String?  @default("Eksporyuk")
  brandShortName                  String?  @default("EYK")
  tagline                         String?  @default("Platform Ekspor Indonesia")
  cardBg                          String?  @default("#ffffff")
  typographyHeadingSize           String?  @default("2rem")
  typographyBodySize              String?  @default("1rem")
  typographyFontFamily            String?  @default("Inter, sans-serif")
  featureGroupEnabled             Boolean  @default(true)
  featureFeedEnabled              Boolean  @default(true)
  featureCommentEnabled           Boolean  @default(true)
  featureLikeEnabled              Boolean  @default(true)
  featureShareEnabled             Boolean  @default(true)
  featureChatEnabled              Boolean  @default(true)
  featureNotificationEnabled      Boolean  @default(true)
  featureAffiliateEnabled         Boolean  @default(true)
  featureAffiliateShortLink       Boolean  @default(true)
  featureAffiliateLeaderboard     Boolean  @default(true)
  featureAffiliateChallenge       Boolean  @default(true)
  featureAffiliateTraining        Boolean  @default(true)
  featureAffiliateReward          Boolean  @default(true)
  featureAffiliateWithdraw        Boolean  @default(true)
  featureAffiliateStatistics      Boolean  @default(true)
  featureAffiliateMarketingKit    Boolean  @default(true)
  featureCourseEnabled            Boolean  @default(true)
  featureCourseEnrollment         Boolean  @default(true)
  featureCourseCertificate        Boolean  @default(true)
  featureCourseProgress           Boolean  @default(true)
  featureCourseQuiz               Boolean  @default(true)
  featureSupplierEnabled          Boolean  @default(true)
  featureSupplierCatalog          Boolean  @default(true)
  featureSupplierSampleRequest    Boolean  @default(true)
  featureSupplierDirectOrder      Boolean  @default(true)
  featureCheckoutEnabled          Boolean  @default(true)
  featureCouponEnabled            Boolean  @default(true)
  featureFlashSaleEnabled         Boolean  @default(true)
  featureMemberPremiumClass       Boolean  @default(true)
  featureMemberPremiumGroup       Boolean  @default(true)
  featureMemberPremiumSupplier    Boolean  @default(true)
  featureMemberPremiumDownload    Boolean  @default(true)
  featureMemberPremiumCertificate Boolean  @default(true)
  featureMemberFreeClass          Boolean  @default(true)
  featureMemberFreeGroup          Boolean  @default(true)
  featureMemberFreeCatalog        Boolean  @default(true)
  featureMentorCreateCourse       Boolean  @default(true)
  featureMentorCreateMaterial     Boolean  @default(true)
  featureMentorCreateGroup        Boolean  @default(true)
  featureMentorEditCourse         Boolean  @default(true)
  featureMentorAnalytics          Boolean  @default(true)
  featureMentorManageStudents     Boolean  @default(true)
  notificationEmailEnabled        Boolean  @default(true)
  notificationWhatsappEnabled     Boolean  @default(true)
  notificationPushEnabled         Boolean  @default(true)
  notificationInAppEnabled        Boolean  @default(true)
  paymentContactEmail             String?
  paymentContactName              String?  @default("Customer Service")
  paymentContactPhone             String?
  paymentContactWhatsapp          String?
  paymentUniqueCodeEnabled        Boolean  @default(true)
  paymentUniqueCodeMax            Int      @default(999)
  paymentUniqueCodeMin            Int      @default(1)
  paymentUniqueCodeType           String?  @default("add")
  orderCooldownEnabled            Boolean  @default(true)
  orderCooldownMinutes            Int      @default(5)
}

model ShortLinkDomain {
  id              String   @id
  domain          String
  displayName     String
  isActive        Boolean  @default(true)
  isDefault       Boolean  @default(false)
  isVerified      Boolean  @default(false)
  dnsType         String?
  dnsTarget       String?
  dnsInstructions String?
  totalLinks      Int      @default(0)
  totalClicks     Int      @default(0)
  createdAt       DateTime @default(now())
  updatedAt       DateTime
}

model Story {
  id        String   @id
  groupId   String
  userId    String
  imageUrl  String
  viewCount Int      @default(0)
  createdAt DateTime @default(now())
  expiresAt DateTime
}

model StoryView {
  id       String   @id
  storyId  String
  userId   String
  viewedAt DateTime @default(now())
}

model Supplier {
  id             String    @id
  companyName    String
  province       String
  city           String
  address        String?
  contactPerson  String?
  email          String?
  phone          String?
  whatsapp       String?
  website        String?
  businessType   String?
  products       String
  capacity       String?
  certifications String?
  isVerified     Boolean   @default(false)
  verifiedBy     String?
  verifiedAt     DateTime?
  rating         Float?    @default(0)
  totalDeals     Int       @default(0)
  tags           String?
  notes          String?
  addedBy        String
  viewCount      Int       @default(0)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
  legalityDoc    String?
  nibDoc         String?
}

model SupplierMembership {
  id            String    @id
  userId        String
  packageId     String
  startDate     DateTime
  endDate       DateTime?
  isActive      Boolean   @default(true)
  autoRenew     Boolean   @default(false)
  price         Decimal
  paymentId     String?
  paymentMethod String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime
}

model SupplierPackage {
  id                      String              @id
  name                    String
  slug                    String
  type                    SupplierPackageType
  duration                SupplierDuration
  price                   Decimal
  originalPrice           Decimal?
  commissionType          CommissionType      @default(PERCENTAGE)
  affiliateCommissionRate Decimal             @default(30)
  features                Json
  description             String?
  isActive                Boolean             @default(true)
  displayOrder            Int                 @default(0)
  createdAt               DateTime            @default(now())
  updatedAt               DateTime
}

model SupplierProduct {
  id           String                @id
  supplierId   String
  title        String
  slug         String
  description  String?
  images       Json?
  documents    Json?
  category     String?
  tags         String?
  status       SupplierProductStatus @default(DRAFT)
  price        String?
  minOrder     String?
  viewCount    Int                   @default(0)
  likeCount    Int                   @default(0)
  inquiryCount Int                   @default(0)
  createdAt    DateTime              @default(now())
  updatedAt    DateTime
}

model SupplierProfile {
  id               String          @id
  userId           String
  companyName      String
  slug             String
  logo             String?
  banner           String?
  bio              String?
  businessCategory String?
  province         String
  city             String
  address          String?
  contactPerson    String?
  email            String?
  phone            String?
  whatsapp         String?
  website          String?
  facebookUrl      String?
  instagramUrl     String?
  linkedinUrl      String?
  twitterUrl       String?
  legalityDoc      String?
  nibDoc           String?
  isVerified       Boolean         @default(false)
  verifiedAt       DateTime?
  verifiedBy       String?
  isSuspended      Boolean         @default(false)
  suspendedAt      DateTime?
  suspendedBy      String?
  suspendReason    String?
  viewCount        Int             @default(0)
  totalProducts    Int             @default(0)
  totalChats       Int             @default(0)
  rating           Float?          @default(0)
  totalReviews     Int             @default(0)
  createdAt        DateTime        @default(now())
  updatedAt        DateTime
  affiliateLinks   AffiliateLink[]
}

model SupplierView {
  id         String   @id
  userId     String
  supplierId String
  viewedAt   DateTime @default(now())
}

model Transaction {
  id               String            @id
  userId           String
  type             TransactionType
  status           TransactionStatus @default(PENDING)
  amount           Decimal
  customerName     String?
  customerEmail    String?
  customerPhone    String?
  customerWhatsapp String?
  productId        String?
  courseId         String?
  eventId          String?
  description      String?
  reference        String?
  originalAmount   Decimal?
  notes            String?
  paymentMethod    String?
  paymentProvider  String?
  externalId       String?
  paymentUrl       String?
  founderShare     Decimal?
  coFounderShare   Decimal?
  affiliateShare   Decimal?
  mentorShare      Decimal?
  companyFee       Decimal?
  couponId         String?
  discountAmount   Decimal?
  affiliateId      String?
  metadata         Json?
  paidAt           DateTime?
  expiredAt        DateTime?
  createdAt        DateTime          @default(now())
  updatedAt        DateTime
  invoiceNumber    String?
}

model TypingIndicator {
  id        String   @id
  roomId    String
  userId    String
  isTyping  Boolean  @default(true)
  createdAt DateTime @default(now())
  expiresAt DateTime
}

model User {
  id                              String            @id @default(cuid())
  memberCode                      String?           @unique
  email                           String            @unique
  username                        String?           @unique
  name                            String
  password                        String?
  role                            Role              @default(MEMBER_FREE)
  avatar                          String?
  bio                             String?
  phone                           String?
  whatsapp                        String?
  province                        String?
  city                            String?
  district                        String?
  address                         String?
  postalCode                      String?
  latitude                        Float?
  longitude                       Float?
  locationVerified                Boolean           @default(false)
  profileCompleted                Boolean           @default(false)
  isOnline                        Boolean           @default(false)
  lastSeenAt                      DateTime?
  lastActiveAt                    DateTime?
  emailVerified                   Boolean           @default(false)
  isActive                        Boolean           @default(true)
  isSuspended                     Boolean           @default(false)
  suspendReason                   String?
  suspendedAt                     DateTime?
  suspendedBy                     String?
  isFounder                       Boolean           @default(false)
  isCoFounder                     Boolean           @default(false)
  affiliateMenuEnabled            Boolean           @default(false)
  revenueSharePercent             Float?
  emailNotifications              Boolean           @default(true)
  whatsappNotifications           Boolean           @default(false)
  oneSignalPlayerId               String?
  oneSignalSubscribedAt           DateTime?
  oneSignalTags                   Json?
  createdAt                       DateTime          @default(now())
  updatedAt                       DateTime          @updatedAt
  referredById                    String?
  mailketingLists                 Json?
  mailketingSubscriberId          String?
  withdrawalPin                   String?
  withdrawalPinSetAt              DateTime?
  coverImage                      String?
  preferredDashboard              String?
  affiliateLinks                  AffiliateLink[]
  affiliateProfile                AffiliateProfile?
  chatParticipants                ChatParticipant[]
  chatRoomsAsUser1                ChatRoom[]        @relation("ChatRoom_user1")
  chatRoomsAsUser2                ChatRoom[]        @relation("ChatRoom_user2")
  CommentReaction                 CommentReaction[]
  Follow_Follow_followerIdToUser  Follow[]          @relation("Follow_followerIdToUser")
  Follow_Follow_followingIdToUser Follow[]          @relation("Follow_followingIdToUser")
  messagesAsSender                Message[]         @relation("Message_sender")
  Post                            Post[]
  PostComment                     PostComment[]
  PostReaction                    PostReaction[]
  Product                         Product[]
  SavedPost                       SavedPost[]
  UserProduct                     UserProduct[]
  userRoles                       UserRole[]
  wallet                          Wallet?

  @@index([city])
  @@index([district])
  @@index([email])
  @@index([province])
  @@index([role])
  @@index([username])
}

model UserBadge {
  id        String   @id
  userId    String
  badgeId   String
  groupId   String?
  awardedAt DateTime @default(now())
  awardedBy String?
  reason    String?
}

model UserCourseProgress {
  id               String    @id
  userId           String
  courseId         String
  progress         Int       @default(0)
  lastAccessedAt   DateTime  @default(now())
  completedLessons Json?
  isCompleted      Boolean   @default(false)
  completedAt      DateTime?
  hasAccess        Boolean   @default(true)
  accessGrantedAt  DateTime  @default(now())
  accessExpiresAt  DateTime?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime
}

model UserMembership {
  id            String    @id
  userId        String
  membershipId  String
  startDate     DateTime  @default(now())
  endDate       DateTime
  isActive      Boolean   @default(true)
  autoRenew     Boolean   @default(false)
  status        String    @default("PENDING")
  activatedAt   DateTime?
  price         Decimal?
  transactionId String?   @unique
  createdAt     DateTime  @default(now())
  updatedAt     DateTime

  @@unique([userId, membershipId])
  @@index([endDate])
  @@index([membershipId])
  @@index([status])
  @@index([userId])
}

model UserPermission {
  id        String   @id
  userId    String
  feature   String
  enabled   Boolean  @default(true)
  value     Json?
  createdAt DateTime @default(now())
  updatedAt DateTime
}

model UserPoints {
  id          String   @id
  userId      String
  groupId     String?
  points      Int      @default(0)
  totalEarned Int      @default(0)
  level       Int      @default(1)
  updatedAt   DateTime
}

model UserProduct {
  id            String    @id
  userId        String
  productId     String
  purchaseDate  DateTime  @default(now())
  expiresAt     DateTime?
  isActive      Boolean   @default(true)
  price         Decimal
  transactionId String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime
  Product       Product   @relation(fields: [productId], references: [id], onDelete: Cascade)
  User          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model UserRole {
  id        String   @id
  userId    String
  role      Role
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, role])
  @@index([userId])
  @@index([role])
}

model Wallet {
  id             String   @id @default(cuid())
  userId         String   @unique
  balance        Decimal  @default(0)
  balancePending Decimal  @default(0)
  totalEarnings  Decimal  @default(0)
  totalPayout    Decimal  @default(0)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model WalletTransaction {
  id          String   @id
  walletId    String
  amount      Decimal
  type        String
  description String
  reference   String?
  createdAt   DateTime @default(now())

  @@index([createdAt])
  @@index([walletId])
}

model WhatsAppTemplate {
  id         String   @id
  name       String
  category   String?
  roleTarget String?
  message    String
  ctaText    String?
  ctaLink    String?
  maxLength  Int      @default(1024)
  variables  Json?
  metadata   Json?
  usageCount Int      @default(0)
  isActive   Boolean  @default(true)
  createdAt  DateTime @default(now())
  updatedAt  DateTime
}

model support_ticket_messages {
  id              String   @id
  ticketId        String
  senderId        String
  senderRole      Role
  message         String
  attachments     Json?
  isSystemMessage Boolean  @default(false)
  createdAt       DateTime @default(now())
  updatedAt       DateTime
}

model support_tickets {
  id                  String         @id
  ticketNumber        String
  userId              String
  userRole            Role
  title               String
  category            TicketCategory
  priority            TicketPriority @default(MEDIUM)
  status              TicketStatus   @default(OPEN)
  assignedToId        String?
  assignedAt          DateTime?
  relatedOrderId      String?
  relatedMembershipId String?
  relatedCourseId     String?
  createdAt           DateTime       @default(now())
  updatedAt           DateTime
  closedAt            DateTime?
  resolvedAt          DateTime?
}

model CourseMentor {
  id        String   @id
  courseId  String
  mentorId  String
  role      String   @default("MENTOR")
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime

  @@unique([courseId, mentorId])
}

model SystemScan {
  id            String       @id @default(cuid())
  scanType      ScanType     @default(FULL)
  status        ScanStatus   @default(RUNNING)
  startedAt     DateTime     @default(now())
  completedAt   DateTime?
  totalChecks   Int          @default(0)
  passedChecks  Int          @default(0)
  failedChecks  Int          @default(0)
  warningChecks Int          @default(0)
  healthScore   Int          @default(100)
  runBy         String?
  metadata      Json?
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
  results       ScanResult[]

  @@index([status])
  @@index([scanType])
  @@index([createdAt])
}

model ScanResult {
  id         String       @id @default(cuid())
  scanId     String
  category   ScanCategory
  checkName  String
  status     ResultStatus
  level      ErrorLevel   @default(INFO)
  message    String
  details    String?
  location   String?
  impact     String?
  suggestion String?
  isFixed    Boolean      @default(false)
  fixedAt    DateTime?
  fixedBy    String?
  fixMethod  String?
  isIgnored  Boolean      @default(false)
  ignoredAt  DateTime?
  ignoredBy  String?
  createdAt  DateTime     @default(now())
  scan       SystemScan   @relation(fields: [scanId], references: [id], onDelete: Cascade)

  @@index([scanId])
  @@index([category])
  @@index([status])
  @@index([level])
}

model FixLog {
  id           String       @id @default(cuid())
  resultId     String?
  category     ScanCategory
  errorType    String
  errorMessage String
  fixMethod    String
  fixedBy      String
  isAutoFix    Boolean      @default(false)
  success      Boolean      @default(true)
  notes        String?
  createdAt    DateTime     @default(now())

  @@index([category])
  @@index([createdAt])
}

model ScanSchedule {
  id        String    @id @default(cuid())
  name      String
  scanType  ScanType  @default(FULL)
  interval  String    @default("daily")
  isActive  Boolean   @default(true)
  lastRunAt DateTime?
  nextRunAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

enum AccessLevel {
  PUBLIC
  MEMBER_ONLY
  PREMIUM_ONLY
  PRIVATE
}

enum AffiliateLinkType {
  SALESPAGE_INTERNAL
  SALESPAGE_EXTERNAL
  CHECKOUT
  CHECKOUT_PRO
}

enum ApprovalStatus {
  PENDING
  APPROVED
  REJECTED
}

enum BadgeCategory {
  PARTICIPATION
  ACHIEVEMENT
  SPECIAL
  QUIZ
  LEADERBOARD
}

enum BannerPlacement {
  DASHBOARD
  FEED
  GROUP
  PROFILE
  SIDEBAR
  POPUP
  FLOATING
}

enum BannerType {
  CAROUSEL
  STATIC
  VIDEO
  POPUP
  FLOATING
  INLINE
}

enum ChatRoomType {
  DIRECT
  GROUP
  MENTOR_STUDENT
  SUPPORT
}

enum CommissionType {
  PERCENTAGE
  FLAT
}

enum CouponType {
  PERCENTAGE
  FIXED
}

enum CourseMonetizationType {
  FREE
  PAID
  SUBSCRIPTION
  AFFILIATE
}

enum CourseRoleAccess {
  PUBLIC
  MEMBER
  AFFILIATE
}

enum CourseStatus {
  DRAFT
  PENDING_REVIEW
  APPROVED
  REJECTED
  PUBLISHED
  ARCHIVED
  PRIVATE
}

enum DocumentCategory {
  INVOICE
  PACKING
  SHIPPING
  CONTRACT
  QUOTATION
  CERTIFICATE
  LETTER
  OTHER
}

enum DocumentationCategory {
  ROLES
  FEATURES
  API
  ADMIN
  DATABASE
  GUIDES
  FAQ
  TROUBLESHOOTING
  GLOSSARY
  GETTING_STARTED
}

enum DocumentationStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

enum DownloadStatus {
  SUCCESS
  FAILED
  PENDING
}

enum EventType {
  WEBINAR
  WORKSHOP
  MEETUP
  CONFERENCE
}

enum EventVisibility {
  PUBLIC
  PRIVATE
  MEMBERSHIP_ONLY
  PRODUCT_ONLY
}

enum GroupRole {
  OWNER
  ADMIN
  MODERATOR
  MEMBER
}

enum GroupType {
  PUBLIC
  PRIVATE
  HIDDEN
}

enum MembershipDuration {
  ONE_MONTH
  THREE_MONTHS
  SIX_MONTHS
  TWELVE_MONTHS
  LIFETIME
}

enum MembershipStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

enum MarketingBadge {
  PALING_LARIS
  HARGA_HEMAT
  PROMO_GEDE
  PROMO_GENDENG
  PROMO_AKHIR_TAHUN
  PROMO_AWAL_TAHUN
}

enum NotificationType {
  CHAT_MESSAGE
  COMMENT
  COMMENT_REPLY
  POST
  POST_APPROVED
  POST_REJECTED
  COURSE_DISCUSSION
  COURSE_ENROLLED
  EVENT_REMINDER
  EVENT_REGISTERED
  TRANSACTION
  TRANSACTION_SUCCESS
  FOLLOWER
  FOLLOW
  ACHIEVEMENT
  SYSTEM
  AFFILIATE
  AFFILIATE_APPROVED
  AFFILIATE_REJECTED
  AFFILIATE_COMMISSION
  MEMBERSHIP
  PRODUCT_REVIEW
  CONTENT_UPDATE
  MESSAGE
  REPORT
  REPORT_REVIEWED
  BAN
}

enum PayoutStatus {
  PENDING
  APPROVED
  REJECTED
  PAID
}

enum PostType {
  POST
  STORY
  ANNOUNCEMENT
  POLL
  EVENT
  QUOTE
  SCHEDULED
}

enum ProductStatus {
  DRAFT
  PUBLISHED
  COMING_SOON
  ARCHIVED
}

enum ProductType {
  DIGITAL
  EVENT
  COURSE_BUNDLE
  EBOOK
  TEMPLATE
}

enum QuestionType {
  MULTIPLE_CHOICE
  TRUE_FALSE
  SHORT_ANSWER
  ESSAY
}

enum ReactionType {
  LIKE
  LOVE
  CARE
  HAHA
  WOW
  SAD
  ANGRY
}

enum ReminderChannel {
  EMAIL
  WHATSAPP
  PUSH
  IN_APP
  SMS
}

enum ReminderStatus {
  PENDING
  SENT
  DELIVERED
  OPENED
  CLICKED
  FAILED
  CANCELLED
}

enum ReminderTrigger {
  AFTER_PURCHASE
  BEFORE_EXPIRY
  ON_INACTIVE
  ON_SPECIFIC_DATE
  CONDITIONAL
}

enum ReportStatus {
  PENDING
  REVIEWED
  RESOLVED
  REJECTED
}

enum ReportType {
  POST
  COMMENT
  USER
  GROUP
}

enum Role {
  ADMIN
  MENTOR
  AFFILIATE
  MEMBER_PREMIUM
  MEMBER_FREE
}

enum SubmissionStatus {
  SUBMITTED
  GRADED
  RETURNED
  LATE
}

enum SupplierDuration {
  MONTHLY
  YEARLY
  LIFETIME
}

enum SupplierPackageType {
  FREE
  PREMIUM
  ENTERPRISE
}

enum SupplierProductStatus {
  DRAFT
  ACTIVE
  INACTIVE
  PENDING_REVIEW
}

enum TicketCategory {
  ACCOUNT_LOGIN
  MEMBERSHIP_PAYMENT
  COURSE
  AFFILIATE
  ADS_TRACKING
  BUG_SYSTEM
  OTHER
}

enum TicketPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum TicketStatus {
  OPEN
  IN_PROGRESS
  WAITING_USER
  RESOLVED
  CLOSED
}

enum TransactionStatus {
  PENDING
  SUCCESS
  FAILED
  REFUNDED
}

enum TransactionType {
  MEMBERSHIP
  PRODUCT
  COURSE
  EVENT
  COMMISSION
  PAYOUT
  SUPPLIER_MEMBERSHIP
}

enum ScanType {
  FULL
  API
  DATABASE
  FRONTEND
  SECURITY
  QUICK
}

enum ScanStatus {
  PENDING
  RUNNING
  COMPLETED
  FAILED
  CANCELLED
}

enum ScanCategory {
  API
  DATABASE
  FRONTEND
  SECURITY
  SYSTEM
  PERFORMANCE
}

enum ResultStatus {
  PASS
  FAIL
  WARNING
  SKIP
}

enum ErrorLevel {
  CRITICAL
  HIGH
  MEDIUM
  LOW
  INFO
}
